<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SiDAFI | Pasien</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
</head>
<body class="bg-slate-50 min-h-screen font-sans">
  <header class="bg-white shadow p-4 sticky top-0">
    <h1 class="text-xl font-semibold text-emerald-600">üè• SiDAFI - Pendaftaran Pasien</h1>
  </header>

  <main class="max-w-2xl mx-auto mt-6 bg-white p-6 rounded-lg shadow">
    <h2 class="text-lg font-semibold mb-4">Formulir Pendaftaran</h2>
    <form id="formPasien" class="space-y-3">
      <input type="text" id="nama" class="w-full border p-2 rounded" placeholder="Nama Lengkap" required>
      <input type="number" id="umur" class="w-full border p-2 rounded" placeholder="Umur" required>
      <select id="jk" class="w-full border p-2 rounded">
        <option value="">Pilih Jenis Kelamin</option>
        <option value="Laki-laki">Laki-laki</option>
        <option value="Perempuan">Perempuan</option>
      </select>

      <div>
        <label class="font-medium">Metode Pembayaran</label>
        <select id="metode" class="w-full border p-2 rounded mt-1">
          <option value="">Pilih Metode Pembayaran</option>
          <option value="BPJS">BPJS</option>
          <option value="Asuransi Umum">Asuransi Umum</option>
          <option value="Tunai">Tunai</option>
        </select>
      </div>

      <div id="bpjsField" class="hidden">
        <input type="text" id="noBPJS" class="w-full border p-2 rounded" placeholder="Nomor BPJS">
      </div>

      <div id="asuransiField" class="hidden">
        <input type="text" id="namaAsuransi" class="w-full border p-2 rounded" placeholder="Nama Asuransi / Perusahaan">
      </div>

      <div>
        <label class="font-medium">Asal Faskes</label>
        <select id="faskes" class="w-full border p-2 rounded mt-1">
          <option value="Faskes Tingkat Pertama">Faskes Tingkat Pertama</option>
          <option value="Faskes Lanjutan">Faskes Lanjutan</option>
        </select>
      </div>

      <div>
        <label class="font-medium">Pilih Rumah Sakit Rekanan SiDAFI</label>
        <select id="rumahsakit" class="w-full border p-2 rounded mt-1">
          <option value="RS Harapan Sehat">RS Harapan Sehat</option>
          <option value="RS Mitra Jaya">RS Mitra Jaya</option>
          <option value="RS Sentosa">RS Sentosa</option>
        </select>
      </div>

      <button type="submit" class="w-full bg-emerald-600 text-white py-2 rounded hover:bg-emerald-700">Kirim</button>
    </form>

    <div id="hasil" class="hidden mt-6 text-center border-t pt-4">
      <h3 class="text-lg font-semibold text-emerald-600">Pendaftaran Berhasil!</h3>
      <p id="antrian" class="mt-2 text-lg font-bold">Nomor Antrian: A001</p>
      <svg id="barcode" class="mx-auto my-3"></svg>
      <button id="toFO" class="mt-4 px-4 py-2 bg-sky-600 text-white rounded">Kirim ke Front Office</button>
    </div>
  </main>

  <script>
    const metode = document.getElementById("metode");
    const bpjsField = document.getElementById("bpjsField");
    const asuransiField = document.getElementById("asuransiField");
    const form = document.getElementById("formPasien");
    const hasil = document.getElementById("hasil");

    metode.addEventListener("change", () => {
      bpjsField.classList.add("hidden");
      asuransiField.classList.add("hidden");
      if (metode.value === "BPJS") bpjsField.classList.remove("hidden");
      if (metode.value === "Asuransi Umum") asuransiField.classList.remove("hidden");
    });

    form.addEventListener("submit", e => {
      e.preventDefault();
      const data = {
        nama: nama.value,
        umur: umur.value,
        jk: jk.value,
        metode: metode.value,
        noBPJS: noBPJS.value,
        namaAsuransi: namaAsuransi.value,
        faskes: faskes.value,
        rs: rumahsakit.value
      };

      hasil.classList.remove("hidden");
      JsBarcode("#barcode", "A001", {format: "CODE128", width: 2, height: 60, displayValue: true});

      document.getElementById("toFO").onclick = () => {
        const params = new URLSearchParams(data).toString();
        window.location.href = `admin.html?${params}`;
      };
    });
  </script>
</body>
</html>
